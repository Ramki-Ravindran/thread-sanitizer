= Revision 8e099d1e8be3f598dcefd04d3cd5eb3673d4e098 =

{{{
==================================================================
ThreadSanitizer: data-race in cache_reap

Read of size 4 by thread T298 (K295):
 [<ffffffff81222be1>] cache_reap+0x141/0x350 /mm/slab.c:4075
 [<ffffffff810aaf3e>] process_one_work+0x2ee/0x730 /kernel/workqueue.c:2027
 [<ffffffff810abe9b>] worker_thread+0xcb/0x740 /kernel/workqueue.c:2160
 [<ffffffff810b5a2b>] kthread+0x14b/0x170 /kernel/kthread.c:207
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fd95df0

Previous write of size 4 by thread T1 (K1):
 [<     inlined    >] kmem_cache_alloc+0x8c9/0x9b0 cache_alloc_refill /mm/slab.c:2944
 [<     inlined    >] kmem_cache_alloc+0x8c9/0x9b0 ____cache_alloc /mm/slab.c:3098
 [<     inlined    >] kmem_cache_alloc+0x8c9/0x9b0 __do_cache_alloc /mm/slab.c:3356
 [<     inlined    >] kmem_cache_alloc+0x8c9/0x9b0 slab_alloc /mm/slab.c:3395
 [<ffffffff81228209>] kmem_cache_alloc+0x8c9/0x9b0 /mm/slab.c:3557
 [<     inlined    >] __kernfs_new_node+0x75/0x150 kmem_cache_zalloc /include/linux/slab.h:629
 [<ffffffff812f1db5>] __kernfs_new_node+0x75/0x150 /fs/kernfs/dir.c:526
 [<ffffffff812f36f7>] kernfs_new_node+0x57/0x90 /fs/kernfs/dir.c:558
 [<ffffffff812f3ae1>] kernfs_create_dir_ns+0x41/0xc0 /fs/kernfs/dir.c:771
 [<ffffffff812f732b>] sysfs_create_dir_ns+0x6b/0xf0 /fs/sysfs/dir.c:55
 [<     inlined    >] kobject_add_internal+0x166/0x5b0 create_dir /lib/kobject.c:71
 [<ffffffff814f20f6>] kobject_add_internal+0x166/0x5b0 /lib/kobject.c:229
 [<     inlined    >] kobject_add+0x86/0xe0 kobject_add_varg /lib/kobject.c:354
 [<ffffffff814f27d6>] kobject_add+0x86/0xe0 /lib/kobject.c:399
 [<ffffffff8176ef6c>] device_add+0x3dc/0x9b0 /drivers/base/core.c:1010
 [<ffffffff8176f561>] device_register+0x21/0x30 /drivers/base/core.c:1128
 [<ffffffff815e3c43>] tty_register_device_attr+0x193/0x3d0 /drivers/tty/tty_io.c:3173
 [<     inlined    >] tty_register_driver+0x240/0x3c0 tty_register_device /drivers/tty/tty_io.c:3100
 [<ffffffff815e4100>] tty_register_driver+0x240/0x3c0 /drivers/tty/tty_io.c:3360
 [<ffffffff81db69fe>] vty_init+0x212/0x23c /drivers/tty/vt/vt.c:3064
 [<ffffffff82336e88>] tty_init+0x174/0x17e /drivers/tty/tty_io.c:3589
 [<ffffffff82338509>] chr_dev_init+0xf2/0x102 /drivers/char/mem.c:904
 [<ffffffff8100032d>] do_one_initcall+0xbd/0x220 /init/main.c:794
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcall_level /init/main.c:860
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcalls /init/main.c:868
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_basic_setup /init/main.c:887
 [<ffffffff822fd81a>] kernel_init_freeable+0x2bb/0x382 /init/main.c:1008
 [<ffffffff810004a6>] kernel_init+0x16/0x150 /init/main.c:938
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fc95df0

DBG: addr: ffff8801e5988720
DBG: first offset: 0, second offset: 0
DBG: T298 clock: {T298: 2620, T1: 28259295}
DBG: T1 clock: {T1: 28273825}
==================================================================
}}}

{{{
==================================================================
ThreadSanitizer: data-race in drain_array

Read of size 4 by thread T298 (K295):
 [<ffffffff81221f56>] drain_array+0x36/0x160 /mm/slab.c:4008 (discriminator 1)
 [<ffffffff81222bd9>] cache_reap+0x139/0x350 /mm/slab.c:4073
 [<ffffffff810aaf3e>] process_one_work+0x2ee/0x730 /kernel/workqueue.c:2027
 [<ffffffff810abe9b>] worker_thread+0xcb/0x740 /kernel/workqueue.c:2160
 [<ffffffff810b5a2b>] kthread+0x14b/0x170 /kernel/kthread.c:207
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fd95df0

Previous write of size 4 by thread T6 (K6):
 [<ffffffff812209d5>] transfer_objects+0x85/0xd0 /mm/slab.c:956
 [<     inlined    >] kmem_cache_alloc_node+0x43a/0x9f0 cache_alloc_refill /mm/slab.c:2933
 [<     inlined    >] kmem_cache_alloc_node+0x43a/0x9f0 ____cache_alloc /mm/slab.c:3098
 [<     inlined    >] kmem_cache_alloc_node+0x43a/0x9f0 slab_alloc_node /mm/slab.c:3324
 [<ffffffff8122390a>] kmem_cache_alloc_node+0x43a/0x9f0 /mm/slab.c:3595
 [<     inlined    >] copy_process.part.43+0x14c/0x2d70 alloc_task_struct_node /kernel/fork.c:130
 [<     inlined    >] copy_process.part.43+0x14c/0x2d70 dup_task_struct /kernel/fork.c:305
 [<ffffffff8107aedc>] copy_process.part.43+0x14c/0x2d70 /kernel/fork.c:1193
 [<     inlined    >] do_fork+0x100/0x4d0 copy_process /kernel/fork.c:1163
 [<ffffffff8107dd20>] do_fork+0x100/0x4d0 /kernel/fork.c:1607
 [<ffffffff8107e125>] kernel_thread+0x35/0x50 /kernel/fork.c:1656
 [<ffffffff810a4a00>] __call_usermodehelper+0x40/0xe0 /kernel/kmod.c:333
 [<ffffffff810aaf3e>] process_one_work+0x2ee/0x730 /kernel/workqueue.c:2027
 [<ffffffff810abe9b>] worker_thread+0xcb/0x740 /kernel/workqueue.c:2160
 [<ffffffff810b5a2b>] kthread+0x14b/0x170 /kernel/kthread.c:207
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fc15df0

DBG: addr: ffff8801e5907400
DBG: first offset: 0, second offset: 0
DBG: T298 clock: {T298: 2999, T6: 3760856}
DBG: T6 clock: {T6: 3821168}
==================================================================
}}}

{{{
==================================================================
ThreadSanitizer: data-race in rb_insert_color

Read of size 8 by thread T6 (K6):
 [<     inlined    >] rb_insert_color+0x3d/0x3a0 __rb_insert /lib/rbtree.c:89
 [<ffffffff814f6f5d>] rb_insert_color+0x3d/0x3a0 /lib/rbtree.c:388
 [<ffffffff810cd800>] __enqueue_entity+0x70/0x80 /kernel/sched/fair.c:523
 [<     inlined    >] enqueue_task_fair+0x48c/0x1250 enqueue_entity /kernel/sched/fair.c:2804
 [<ffffffff810d060c>] enqueue_task_fair+0x48c/0x1250 /kernel/sched/fair.c:3948
 [<ffffffff810c32d5>] enqueue_task+0x35/0x60 /kernel/sched/core.c:845
 [<ffffffff810c67be>] activate_task+0x1e/0x20 /kernel/sched/core.c:860
 [<ffffffff810c9be1>] wake_up_new_task+0xd1/0x1b0 /kernel/sched/core.c:2098
 [<ffffffff8107dea6>] do_fork+0x286/0x4d0 /kernel/fork.c:1633
 [<ffffffff8107e125>] kernel_thread+0x35/0x50 /kernel/fork.c:1656
 [<ffffffff810a4a00>] __call_usermodehelper+0x40/0xe0 /kernel/kmod.c:333
 [<ffffffff810aaf3e>] process_one_work+0x2ee/0x730 /kernel/workqueue.c:2027
 [<ffffffff810abe9b>] worker_thread+0xcb/0x740 /kernel/workqueue.c:2160
 [<ffffffff810b5a2b>] kthread+0x14b/0x170 /kernel/kthread.c:207
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fd15df0

Previous write of size 8 by thread T1 (K1):
 [<     inlined    >] rb_insert_color+0x2fe/0x3a0 rb_set_parent_color /include/linux/rbtree_augmented.
h:107
 [<     inlined    >] rb_insert_color+0x2fe/0x3a0 __rb_insert /lib/rbtree.c:87
 [<ffffffff814f721e>] rb_insert_color+0x2fe/0x3a0 /lib/rbtree.c:388
 [<ffffffff810cd800>] __enqueue_entity+0x70/0x80 /kernel/sched/fair.c:523
 [<ffffffff810a77c1>] insert_work+0xd1/0x130 /kernel/workqueue.c:1263
 [<ffffffff810a7a4d>] __queue_work+0x22d/0x570 /kernel/workqueue.c:1378
 [<ffffffff810a8060>] queue_work_on+0x50/0x80 /kernel/workqueue.c:1403
 [<     inlined    >] call_usermodehelper_exec+0x1d4/0x1f0 queue_work /include/linux/workqueue.h:474
 [<ffffffff810a4d04>] call_usermodehelper_exec+0x1d4/0x1f0 /kernel/kmod.c:594
 [<ffffffff814f364e>] kobject_uevent_env+0x65e/0x6c0 /lib/kobject_uevent.c:351
 [<ffffffff814f36d3>] kobject_uevent+0x23/0x40 /lib/kobject_uevent.c:375
 [<     inlined    >] param_sysfs_init+0x1cc/0x1f5 kernel_add_sysfs_param /kernel/params.c:784
 [<     inlined    >] param_sysfs_init+0x1cc/0x1f5 param_sysfs_builtin /kernel/params.c:819
 [<ffffffff8231216a>] param_sysfs_init+0x1cc/0x1f5 /kernel/params.c:939
 [<ffffffff8100032d>] do_one_initcall+0xbd/0x220 /init/main.c:794
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcall_level /init/main.c:860
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcalls /init/main.c:868
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_basic_setup /init/main.c:887
 [<ffffffff822fd81a>] kernel_init_freeable+0x2bb/0x382 /init/main.c:1008
 [<ffffffff810004a6>] kernel_init+0x16/0x150 /init/main.c:938
 [<ffffffff81dcb53c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = 0

DBG: addr: ffff8801e34bf468
DBG: first offset: 0, second offset: 0
DBG: T6 clock: {T6: 1322733, T1: 9261340}
DBG: T1 clock: {T1: 9266129}
==================================================================
}}}

{{{
==================================================================
ThreadSanitizer: data-race in delayed_fput

Read of size 8 by thread T280 (K277):
 [<     inlined    >] delayed_fput+0x28/0x50 llist_next /include/linux/llist.h:165
 [<ffffffff8123a668>] delayed_fput+0x28/0x50 /fs/file_table.c:245
 [<ffffffff810aaf3e>] process_one_work+0x2ee/0x730 /kernel/workqueue.c:2027
 [<ffffffff810abe9b>] worker_thread+0xcb/0x740 /kernel/workqueue.c:2160
 [<ffffffff810b5a2b>] kthread+0x14b/0x170 /kernel/kthread.c:207
 [<ffffffff81dcb67c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fd95df0

Previous write of size 1 by thread T1 (K1):
 [<     inlined    >] kmem_cache_alloc+0xd3/0x9b0 slab_alloc /mm/slab.c:3404
 [<ffffffff81227a13>] kmem_cache_alloc+0xd3/0x9b0 /mm/slab.c:3557
 [<     inlined    >] get_empty_filp+0x9a/0x2c0 kmem_cache_zalloc /include/linux/slab.h:629
 [<ffffffff8123a7ea>] get_empty_filp+0x9a/0x2c0 /fs/file_table.c:122
 [<ffffffff81252d26>] path_openat+0x56/0xb20 /fs/namei.c:3174
 [<ffffffff81254491>] do_filp_open+0x51/0xc0 /fs/namei.c:3243
 [<ffffffff812363c3>] do_sys_open+0x183/0x2d0 /fs/open.c:979
 [<     inlined    >] SyS_open+0x31/0x50 SYSC_open /fs/open.c:997
 [<ffffffff81236541>] SyS_open+0x31/0x50 /fs/open.c:992
 [<ffffffff822ffb7e>] do_name+0x153/0x512 /init/initramfs.c:318
 [<ffffffff822fe8a6>] write_buffer+0x62/0x84 /init/initramfs.c:392 (discriminator 1)
 [<ffffffff822fe90e>] flush_buffer+0x46/0xe0 /init/initramfs.c:404
 [<ffffffff81db1e17>] gunzip+0x39e/0x46f /lib/decompress_inflate.c:146
 [<ffffffff822ff631>] unpack_to_rootfs+0x22e/0x451 /init/initramfs.c:460
 [<ffffffff822ff8f1>] populate_rootfs+0x9d/0x1d7 /init/initramfs.c:614
 [<ffffffff8100032d>] do_one_initcall+0xbd/0x220 /init/main.c:794
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcall_level /init/main.c:860
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_initcalls /init/main.c:868
 [<     inlined    >] kernel_init_freeable+0x2bb/0x382 do_basic_setup /init/main.c:887
 [<ffffffff822fd81a>] kernel_init_freeable+0x2bb/0x382 /init/main.c:1008
 [<ffffffff810004a6>] kernel_init+0x16/0x150 /init/main.c:938
 [<ffffffff81dcb67c>] ret_from_fork+0x7c/0xb0 /arch/x86/kernel/entry_64.S:347
DBG: cpu = ffff88041fd15df0

DBG: addr: ffff8801e3643500
DBG: first offset: 0, second offset: 0
DBG: T280 clock: {T280: 64290, T1: 32106500}
DBG: T1 clock: {T1: 32616364}
==================================================================
}}}